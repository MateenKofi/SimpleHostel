"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const express_1 = require("express");
const jsonwebtoken_1 = require("../utils/jsonwebtoken");
const AccessControl_1 = require("../utils/AccessControl");
const paymentController_1 = require("../controller/paymentController");
const payStackWebhook_1 = require("../utils/payStackWebhook");
const paymentRouter = (0, express_1.Router)();
paymentRouter.post("/webhook", payStackWebhook_1.handlePaystackWebhook);
paymentRouter.post("/init/", paymentController_1.initiatePayment);
paymentRouter.get("/confirm", paymentController_1.handlePaymentConfirmation);
paymentRouter.post("/topup", paymentController_1.initializeTopUpPaymentControler);
paymentRouter.post("/topup/confirm", paymentController_1.TopUpPaymentController);
paymentRouter.get("/get", jsonwebtoken_1.authenticateJWT, (0, jsonwebtoken_1.authorizeRole)(["super_admin"]), paymentController_1.getAllPaymentController);
paymentRouter.get("/get/ref/:reference", paymentController_1.getPaymentByReferenceController);
paymentRouter.get("/get/:paymentId", jsonwebtoken_1.authenticateJWT, (0, jsonwebtoken_1.authorizeRole)(["admin", "super_admin"]), AccessControl_1.validateHostelAccess, paymentController_1.getPaymentByIdController);
paymentRouter.get("/get/hostel/:hostelId", jsonwebtoken_1.authenticateJWT, (0, jsonwebtoken_1.authorizeRole)(["admin", "super_admin"]), AccessControl_1.validateHostelAccess, paymentController_1.getPaymentsForHostelController);
paymentRouter.post("/fix-orphaned-payments", jsonwebtoken_1.authenticateJWT, (0, jsonwebtoken_1.authorizeRole)(["super_admin"]), paymentController_1.fixOrphanedPaymentsController);
exports.default = paymentRouter;
